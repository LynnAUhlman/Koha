---shows each patron transaction on a separate line, but noting what/how many ccode they checked out
---no borrower information, but can be easily added if needed

SELECT 
  DATE(s.datetime) AS 'date',
  p.borrowernumber,
  p.categorycode AS 'category_code',
  SUM(i.ccode = 'AUDIOBOOKS') AS 'AUDIOBOOKS',
  SUM(i.ccode = 'BIOGRAPHY') AS 'BIOGRAPHY',
  SUM(i.ccode = 'BOOKPACKS') AS 'BOOKPACKS',
  SUM(i.ccode = 'FICTION') AS 'FICTION',
  SUM(i.ccode = 'HOTSPOT') AS 'HOTSPOT',
  SUM(i.ccode = 'ILL') AS 'ILL',
  SUM(i.ccode = 'JAUDIO') AS 'JAUDIO',
  SUM(i.ccode = 'JBEGRDR') AS 'JBEGRDR',
  SUM(i.ccode = 'JBIO') AS 'JBIO',
  SUM(i.ccode = 'JBOARD') AS 'JBOARD',
  SUM(i.ccode = 'JDVD') AS 'JDVD',
  SUM(i.ccode = 'JEASY') AS 'JEASY',
  SUM(i.ccode = 'JELEMFIC') AS 'JELEMFIC',
  SUM(i.ccode = 'JFIC') AS 'JFIC',
  SUM(i.ccode = 'JGN') AS 'JGN',
  SUM(i.ccode = 'JNONFIC') AS 'JNONFIC',
  SUM(i.ccode = 'KIT') AS 'KIT',
  SUM(i.ccode = 'LAUNCHPAD') AS 'LAUNCHPAD',
  SUM(i.ccode = 'LP') AS 'LP',
  SUM(i.ccode = 'NF') AS 'NF',
  SUM(i.ccode = 'PLAYAWAY') AS 'PLAYAWAY',
  SUM(i.ccode = 'PRO') AS 'PRO',
  SUM(i.ccode = 'REF') AS 'REF',
  SUM(i.ccode = 'ROOM') AS 'ROOM',
  SUM(i.ccode = 'SEEDS') AS 'SEEDS',
  SUM(i.ccode = 'SOLACTVY') AS 'SOLACTVY',
  SUM(i.ccode = 'SPANISH') AS 'SPANISH',
  SUM(i.ccode = 'TECHMISC') AS 'TECHMISC',
  SUM(i.ccode = 'VIDEOS') AS 'VIDEOS',
  SUM(i.ccode = 'YAFIC') AS 'YAFIC',
  SUM(i.ccode = 'YAGN') AS 'YAGN',
  SUM(i.ccode = 'YANF') AS 'YANF',
  SUM(i.ccode = 'ZCEMETERY') AS 'ZCEMETERY'
FROM statistics s
LEFT JOIN borrowers p ON s.borrowernumber = p.borrowernumber
LEFT JOIN items i ON s.itemnumber = i.itemnumber
WHERE 
  DATE(s.datetime) BETWEEN <<Checked out between|date>> AND <<and|date>>
  AND s.type = 'issue'
GROUP BY DATE(s.datetime), p.borrowernumber, p.categorycode
ORDER BY DATE(s.datetime), p.borrowernumber
